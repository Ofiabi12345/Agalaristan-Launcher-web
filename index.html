<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>Agalaristan Network | Resmi Market</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script src="https://bundle.run/skinview3d@3.0.0"></script>
    <style>
        :root { --vurgu: #00d2ff; --altin: #ffcf40; --arkaplan: #0a0a0f; }
        body { margin: 0; font-family: 'Poppins', sans-serif; color: white; background: var(--arkaplan); overflow-x: hidden; }
        .overlay { background: rgba(10, 10, 15, 0.9); min-height: 100vh; backdrop-filter: blur(10px); padding: 20px 8%; }
        
        nav { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--vurgu); padding-bottom: 20px; }
        .logo { font-size: 28px; font-weight: 900; color: var(--vurgu); text-shadow: 0 0 10px var(--vurgu); }
        .admin-btn { color: var(--altin); border: 1px solid var(--altin); padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold; }

        /* 3D Önizleme */
        .preview-box { display: flex; flex-direction: column; align-items: center; margin: 40px 0; background: rgba(255,255,255,0.02); padding: 20px; border-radius: 20px; }
        #skin-viewer { width: 300px; height: 400px; }

        /* Market Kartları */
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 30px; margin-top: 30px; }
        .card { background: #15151b; padding: 25px; border-radius: 20px; border: 1px solid #333; text-align: center; transition: 0.3s; }
        .card:hover { border-color: var(--vurgu); transform: translateY(-10px); }
        .price { font-size: 30px; color: #2ecc71; font-weight: bold; margin: 15px 0; }
        .buy-btn { background: var(--vurgu); color: black; padding: 12px 25px; border-radius: 50px; font-weight: bold; cursor: pointer; display: inline-block; }

        #owner-bar { display: none; background: #ff4757; color: white; text-align: center; padding: 10px; font-weight: bold; position: fixed; top: 0; left: 0; width: 100%; z-index: 1001; }
    </style>
</head>
<body>

<div id="owner-bar">SAHİP MODU: HOŞ GELDİN OFİABİ! TÜM FİYATLAR 0 TL.</div>

<div class="overlay">
    <nav>
        <div class="logo">AGALARİSTAN</div>
        <div id="auth-section">
            <input type="text" id="user-input" placeholder="Kullanıcı Adı" style="padding:8px; border-radius:5px; border:none;">
            <input type="password" id="pass-input" placeholder="Şifre" style="padding:8px; border-radius:5px; border:none;">
            <span class="admin-btn" onclick="checkAdmin()">GİRİŞ</span>
        </div>
    </nav>

    <div class="preview-box">
        <h2>3D PELERİN VE SKİN ÖNİZLEME</h2>
        <p style="font-size: 12px; color: #888;">İsmini yaz: <input type="text" id="skin-name" oninput="changeSkin()" placeholder="Ofiabi123" style="background:transparent; color:white; border:1px solid #444; padding:5px;"></p>
        <div id="skin-viewer"></div>
    </div>

    <div class="grid">
        <div class="card">
            <h3>[RVIP] Paketi</h3>
            <div class="price" id="p1">250 TL</div>
            <div class="buy-btn" onclick="satinAlTalebi('RVIP', '250 TL')">SATIN AL</div>
        </div>
        <div class="card">
            <h3>Ejderha Pelerini</h3>
            <div class="price" id="p2">100 TL</div>
            <div class="buy-btn" onclick="applyCape('https://i.imgur.com/v0Xp6N8.png', 'Ejderha Pelerini', '100 TL')">ÜSTÜNDE DENE & AL</div>
        </div>
    </div>
</div>

<script>
    // --- GMAIL BİLDİRİM AYARI ---
    // EmailJS sitesinden aldığın "Public Key"i buraya yazmalısın.
    (function(){
        emailjs.init("YOUR_PUBLIC_KEY_BURAYA"); 
    })();

    // 3D Skin Ayarları
    let viewer = new skinview3d.SkinViewer({
        canvas: document.getElementById("skin-viewer"),
        width: 300,
        height: 400,
        skin: "https://mineskin.org/render/head/Steve"
    });
    viewer.autoRotate = true;
    viewer.animation = new skinview3d.WalkingAnimation();

    let adminAktif = false;

    function checkAdmin() {
        const u = document.getElementById('user-input').value;
        const p = document.getElementById('pass-input').value;
        if(u === "Ofiabi123" && p === "1st2nd3rdAzaZ") {
            adminAktif = true;
            document.getElementById('owner-bar').style.display = "block";
            document.getElementById('p1').innerText = "0 TL";
            document.getElementById('p2').innerText = "0 TL";
            viewer.loadSkin(`https://mineskin.org/render/head/${u}`);
            alert("Selam Sahip! Gmail bildirimleri ve Beleş modu aktif.");
        } else {
            alert("Giriş yapıldı! (Normal Kullanıcı)");
        }
    }

    function changeSkin() {
        const name = document.getElementById('skin-name').value;
        if(name.length > 2) viewer.loadSkin(`https://mineskin.org/render/head/${name}`);
    }

    function applyCape(capeUrl, urunAd, fiyat) {
        viewer.loadCape(capeUrl);
        satinAlTalebi(urunAd, fiyat);
    }

    function satinAlTalebi(urun, fiyat) {
        const oyuncu = document.getElementById('user-input').value || "Bilinmiyor";
        
        if(adminAktif) {
            alert("Sen sahipsin, " + urun + " zaten senin!");
        } else {
            alert("Talebin Ofiabi123321@gmail.com adresine iletiliyor...");
            
            // Gmail'e Mail Gönderme (EmailJS üzerinden)
            const templateParams = {
                to_email: 'Ofiabi123321@gmail.com',
                from_name: oyuncu,
                message: `${oyuncu} adlı oyuncu ${urun} (${fiyat}) satın almak istiyor!`
            };

            emailjs.send('YOUR_SERVICE_ID', 'YOUR_TEMPLATE_ID', templateParams)
                .then(function() {
                    alert("Mail başarıyla gönderildi! Ofiabi seninle iletişime geçecek.");
                }, function(error) {
                    console.log("Hata:", error);
                    alert("Mail gönderilemedi ama loglara kaydedildi.");
                });
        }
    }
</script>

</body>
</html>
